@* @model List<CRUDMVC.Models.Entities.Student>

<div class="container-fluid bg-light min-vh-100 px-4 px-lg-5 py-5">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold mb-0 mx-auto">Students</h2>
    </div>

    <div class="card border-0 shadow-sm rounded-4">
        <div class="card-body p-0">

            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0 p-5">

                    <thead class="table-dark">
                        <tr>
                            <th class="py-3">Name</th>
                            <th class="py-3">Email</th>
                            <th class="text-center py-3">Edit</th>
                            <th class="text-center py-3">Delete</th>
                            <th class="text-center py-3">View</th>
                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var student in Model)
                        {
                            <tr>
                                <td class="py-3" style="padding:3rem;">@student.Name</td>
                                <td class="py-3 text-muted" style="padding:3rem;">@student.Email</td>

                                <td class="text-center py-3">
                                    <a asp-controller="Students"
                                       asp-action="Edit"
                                       asp-route-id="@student.Id"
                                       class="btn btn-outline-primary btn-sm px-3">
                                        Edit
                                    </a>
                                </td>

                                <td class="text-center py-3">
                                    <form asp-controller="Students"
                                          asp-action="Delete"
                                          asp-route-id="@student.Id"
                                          method="post"
                                          class="d-inline">
                                        <button type="submit"
                                                class="btn btn-outline-danger btn-sm px-3">
                                            Delete
                                        </button>
                                    </form>
                                </td>

                                <td class="text-center py-3">
                                    <a asp-controller="Students"
                                       asp-action="ViewStudent"
                                       asp-route-id="@student.Id"
                                       class="btn btn-outline-success btn-sm px-3">
                                        View
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>

                </table>
            </div>
        </div>
    </div>

</div> *@



@model List<CRUDMVC.Models.Entities.Student>

<div class="container-fluid bg-light min-vh-100 px-4 px-lg-5 py-5">

    <h2 class="fw-bold text-center mb-5">Students</h2>

   
       
    <div class="search-container">
        <i class="fa-solid fa-magnifying-glass search-icon"></i>
        <input type="text" id="liveSearch" class="form-control form-control-lg shadow-sm mb-3" placeholder="search by name or email..." />
    </div>

    <div class="student-stack">
        @foreach (var student in Model)
        {
            <div class="student-stack-card shadow-sm 
                 data-name="@(student.Name?.ToLower() ?? "")"
                 data-email="@(student.Email?.ToLower() ?? "")"
            ">

                <div class="student-avatar">
                    @student.Name.Substring(0, 1).ToUpper()
                </div>

                <div class="student-info">
                    <h5 class="mb-1 fw-semibold">@student.Name</h5>
                    <p class="text-muted mb-0">@student.Email</p>
                </div>

                <div class="student-actions">
                    <a asp-controller="Students"
                       asp-action="ViewStudent"
                       asp-route-id="@student.Id"
                       class="btn btn-outline-success btn-sm">
                        View
                    </a>

                    <a asp-controller="Students"
                       asp-action="Edit"
                       asp-route-id="@student.Id"
                       class="btn btn-outline-primary btn-sm">
                        Edit
                    </a>

                    <form asp-controller="Students"
                           asp-action="Delete"
                           asp-route-id="@student.Id"
                           method="post"
                           class="delete-form">

                        <button type="button"
                                class="btn btn-outline-danger btn-sm delete-btn"
                                data-student-name="@student.Name">
                            Delete
                        </button>

                    </form>
                </div>

            </div>
        }
    </div>

    <p id="noResults" class="text-center text-muted mt-4 d-none">
        No students found
    </p>
</div>

<div class="modal fade" id="deleteModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4">

            <div class="modal-header border-0">
                <h5 class="modal-title fw-bold text-danger">
                    Confirm Delete
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body text-center">
                <p id="deleteMessage" class="mb-0">
                    Are you sure you want to delete this student?
                </p>
            </div>

            <div class="modal-footer border-0 justify-content-center">
                <button type="button"
                        class="btn btn-secondary px-4"
                        data-bs-dismiss="modal">
                    Cancel
                </button>

                <button type="button"
                        class="btn btn-danger px-4"
                        id="confirmDelete">
                    Yes, Delete
                </button>
            </div>

        </div>
    </div>
</div>


<script>
    document.addEventListener("DOMContentLoaded", function () {

        const searchInput = document.getElementById("liveSearch");
        const cards = document.querySelectorAll(".student-stack-card");
        const noResults = document.getElementById("noResults");

        const deleteButtons = document.querySelectorAll(".delete-btn");
        const deleteModal = new bootstrap.Modal(document.getElementById("deleteModal"));
        const confirmDeleteBtn = document.getElementById("confirmDelete");
        const deleteMessage = document.getElementById("deleteMessage");

        let formToSubmit = null;

        searchInput.addEventListener("input", function () {
            const value = this.value.toLowerCase();
            let visibleCount = 0;

            cards.forEach(card => {
                const name = card.dataset.name || "";
                const email = card.dataset.email || "";

                if (name.includes(value) || email.includes(value)) {
                    card.style.display = "flex";
                    visibleCount++;
                } else {
                    card.style.display = "none";
                }
            });

            noResults.classList.toggle("d-none", visibleCount !== 0);
        });

        deleteButtons.forEach(button => {
            button.addEventListener("click", function () {
                formToSubmit = this.closest("form");

                const studentName = this.dataset.studentName || "this student";
                deleteMessage.textContent =
                    `Are you sure you want to delete ${studentName}?`;

                deleteModal.show();
            });
        });

        confirmDeleteBtn.addEventListener("click", function () {
            if (formToSubmit) {
                formToSubmit.submit();
            }
        });

    });
</script>

